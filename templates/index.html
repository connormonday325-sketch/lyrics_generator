<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lyrics AI</title>
  <link rel="stylesheet" href="/static/style.css">
</head>

<body>

  <div class="container">

    <h1>ğŸµ Lyrics AI</h1>
    <p class="subtitle">Generate professional lyrics in seconds</p>

    <input type="text" id="topic" placeholder="Enter song topic (e.g love, hustle, money)">

    <select id="style">
      <option value="Afrobeats">Afrobeats</option>
      <option value="Trap">Trap</option>
      <option value="Drill">Drill</option>
      <option value="Gospel">Gospel</option>
      <option value="R&B">R&B</option>
      <option value="Love Song">Love Song</option>
    </select>

    <select id="mood">
      <option value="Happy">Happy</option>
      <option value="Sad">Sad</option>
      <option value="Motivational">Motivational</option>
      <option value="Romantic">Romantic</option>
      <option value="Street">Street</option>
    </select>

    <select id="artist">
      <option value="None">Artist Inspiration</option>
      <option value="Wizkid">Wizkid</option>
      <option value="Davido">Davido</option>
      <option value="Burna Boy">Burna Boy</option>
      <option value="Asake">Asake</option>
      <option value="Omah Lay">Omah Lay</option>
      <option value="Rema">Rema</option>
      <option value="Drake">Drake</option>
    </select>

    <div class="modeBox">
      <button class="modeBtn active" id="freeModeBtn">Free</button>
      <button class="modeBtn" id="premiumModeBtn">Premium ğŸ”’</button>
    </div>

    <button class="generateBtn" onclick="generateLyrics()">âœ¨ Generate Lyrics</button>

    <div id="loading" class="loading hidden">
      â³ Generating lyrics...
    </div>

    <div class="outputBox" id="outputBox">
      <pre id="output">Your lyrics will appear here...</pre>
    </div>

    <div class="buttons">
      <button class="copyBtn" onclick="copyLyrics()">ğŸ“‹ Copy</button>
      <button class="downloadBtn" onclick="downloadLyrics()">â¬‡ Download</button>
      <button class="shareBtn" onclick="shareLyrics()">ğŸ“± Share</button>
    </div>

    <div class="historyBox">
      <h2>ğŸ“œ Lyrics History</h2>
      <div id="historyList"></div>
      <button class="clearBtn" onclick="clearHistory()">ğŸ—‘ Clear History</button>
    </div>

  </div>

<script>
  let mode = "free";

  const freeBtn = document.getElementById("freeModeBtn");
  const premiumBtn = document.getElementById("premiumModeBtn");

  freeBtn.onclick = () => {
    mode = "free";
    freeBtn.classList.add("active");
    premiumBtn.classList.remove("active");
  };

  premiumBtn.onclick = () => {
    alert("Premium Mode is locked ğŸ”’\n\nLater we will connect Paystack so users can unlock Premium.");
    mode = "premium";
    premiumBtn.classList.add("active");
    freeBtn.classList.remove("active");
  };

  async function generateLyrics() {
    const topic = document.getElementById("topic").value;
    const style = document.getElementById("style").value;
    const mood = document.getElementById("mood").value;
    const artist = document.getElementById("artist").value;

    document.getElementById("loading").classList.remove("hidden");

    const response = await fetch("/generate", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ topic, style, mood, artist, mode })
    });

    const data = await response.json();

    document.getElementById("loading").classList.add("hidden");

    if (data.error) {
      alert(data.message);
      return;
    }

    document.getElementById("output").textContent = data.lyrics;

    saveToHistory(data.lyrics);
    loadHistory();
  }

  function copyLyrics() {
    const lyrics = document.getElementById("output").textContent;
    navigator.clipboard.writeText(lyrics);
    alert("Lyrics copied!");
  }

  function downloadLyrics() {
    const lyrics = document.getElementById("output").textContent;
    const blob = new Blob([lyrics], { type: "text/plain" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "lyrics.txt";
    link.click();
  }

  function shareLyrics() {
    const lyrics = document.getElementById("output").textContent;

    if (navigator.share) {
      navigator.share({
        title: "Lyrics AI",
        text: lyrics
      });
    } else {
      alert("Sharing not supported on this device.");
    }
  }

  function saveToHistory(lyrics) {
    let history = JSON.parse(localStorage.getItem("lyricsHistory")) || [];
    history.unshift(lyrics);

    if (history.length > 10) {
      history.pop();
    }

    localStorage.setItem("lyricsHistory", JSON.stringify(history));
  }

  function loadHistory() {
    let history = JSON.parse(localStorage.getItem("lyricsHistory")) || [];
    const historyList = document.getElementById("historyList");
    historyList.innerHTML = "";

    history.forEach((item, index) => {
      const div = document.createElement("div");
      div.className = "historyItem";
      div.innerText = "Lyrics " + (index + 1) + " (Tap to open)";
      div.onclick = () => {
        document.getElementById("output").textContent = item;
      };
      historyList.appendChild(div);
    });
  }

  function clearHistory() {
    localStorage.removeItem("lyricsHistory");
    loadHistory();
    alert("History cleared!");
  }

  loadHistory();
</script>

</body>
        </html>
